rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Secure the /users/{userID} collection and all subcollections (like solves)
    match /users/{userID}/{document=**} {
      // Allow read/write only if the user is authenticated and their UID matches the path's userID
      allow read, write: if request.auth != null && request.auth.uid == userID;
    }
  }
}